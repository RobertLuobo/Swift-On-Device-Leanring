import numpy as np
import matplotlib.pyplot as plt

'''Not QAT'''
Train_Acc_list = [7.421875, 70.01953125, 78.3203125, 84.9609375, 81.8359375, 87.3046875, 85.9375, 87.20703125, 87.79296875, 85.05859375, 88.37890625, 90.52734375, 88.96484375, 89.2578125, 94.04296875, 97.65625, 97.94921875, 98.2421875, 98.4375, 98.33984375, 98.6328125, 98.6328125, 98.4375, 98.14453125, 98.828125, 98.14453125, 98.828125, 99.21875, 98.828125, 98.92578125, 98.2421875, 99.4140625, 98.4375, 99.12109375, 99.31640625, 98.6328125, 99.21875, 99.0234375, 98.6328125, 99.51171875, 98.6328125, 98.73046875, 99.21875, 99.12109375, 98.73046875, 99.31640625, 98.92578125, 98.6328125, 99.12109375, 98.828125, 98.73046875, 98.53515625, 99.12109375, 99.21875, 99.51171875, 99.4140625, 98.6328125, 98.92578125, 99.21875, 99.31640625, 98.73046875, 99.4140625, 98.828125, 98.92578125, 98.73046875, 98.828125, 98.828125, 98.2421875, 99.12109375, 98.4375, 99.12109375, 98.6328125, 98.73046875, 99.12109375, 98.6328125, 99.31640625, 98.53515625, 99.0234375, 99.21875, 99.12109375, 98.92578125, 99.21875, 98.92578125, 98.6328125, 98.4375, 99.31640625, 98.828125, 99.0234375, 98.046875, 99.4140625, 99.51171875, 99.21875, 98.92578125, 99.12109375, 99.0234375, 99.609375, 99.31640625, 98.53515625, 99.12109375, 99.12109375]
Train_Loss_list = [2.321005344390869, 0.9380407333374023, 0.7671316862106323, 0.43027713894844055, 0.4873267710208893, 0.35981279611587524, 0.3774281442165375, 0.33825448155403137, 0.3177226483821869, 0.38260915875434875, 0.3092145621776581, 0.25419509410858154, 0.27474188804626465, 0.26721224188804626, 0.2695772349834442, 0.07672547549009323, 0.07665912061929703, 0.06175558269023895, 0.050430767238140106, 0.06065099313855171, 0.04749255254864693, 0.04349707067012787, 0.03898635134100914, 0.05875302106142044, 0.0378916934132576, 0.05324074625968933, 0.044819459319114685, 0.041914794594049454, 0.04093554615974426, 0.03406394645571709, 0.054976142942905426, 0.036638639867305756, 0.0526549369096756, 0.035045452415943146, 0.03293706849217415, 0.04045233875513077, 0.02765674702823162, 0.03351911902427673, 0.04076666384935379, 0.022030266001820564, 0.04293692111968994, 0.05625402554869652, 0.03814471513032913, 0.044445402920246124, 0.0476742647588253, 0.031139221042394638, 0.029613204300403595, 0.051887527108192444, 0.03262864798307419, 0.05024697631597519, 0.036394499242305756, 0.05918208137154579, 0.03309056535363197, 0.03220631182193756, 0.03175026923418045, 0.025301244109869003, 0.04522070288658142, 0.04663527384400368, 0.04269993305206299, 0.032135508954524994, 0.042838651686906815, 0.02826554886996746, 0.037655457854270935, 0.03274748474359512, 0.04203693941235542, 0.03943257033824921, 0.03873704373836517, 0.05147674307227135, 0.03065607137978077, 0.049318719655275345, 0.0352555513381958, 0.055092211812734604, 0.0398569218814373, 0.04317783564329147, 0.05154222249984741, 0.03626735135912895, 0.05300905928015709, 0.04333386570215225, 0.03146345913410187, 0.04351399466395378, 0.0413404256105423, 0.03275277465581894, 0.041776373982429504, 0.05060076713562012, 0.06077268347144127, 0.02830968052148819, 0.038216084241867065, 0.04457956552505493, 0.07004174590110779, 0.030851295217871666, 0.02674066089093685, 0.03510256111621857, 0.048706743866205215, 0.04504731670022011, 0.0417344756424427, 0.022464917972683907, 0.03588983789086342, 0.04080129787325859, 0.04110449552536011, 0.03226853907108307]
Test_Acc_list = [21.79, 69.13, 78.94, 84.35, 85.54, 86.74, 87.13, 87.69, 87.91, 88.0, 88.36, 88.4, 88.32, 88.5, 97.84, 97.56, 97.77, 97.96, 98.36, 98.37, 98.28, 98.41, 98.43, 98.39, 98.43, 98.47, 98.48, 98.44, 98.5, 98.48, 98.48, 98.5, 98.49, 98.53, 98.48, 98.49, 98.52, 98.48, 98.52, 98.51, 98.57, 98.53, 98.52, 98.5, 98.52, 98.56, 98.57, 98.55, 98.54, 98.54, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.52, 98.52, 98.53, 98.52, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.52, 98.51, 98.52, 98.52, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.53, 98.54, 98.53, 98.54, 98.53, 98.52, 98.52, 98.54, 98.53, 98.53, 98.53, 98.53, 98.54, 98.55, 98.53]
Test_Loss_list = [22.97366714477539, 17.61397659778595, 10.532685101032257, 4.912864446640015, 4.2743421494960785, 3.6806095838546753, 3.4758321344852448, 3.269817501306534, 3.159455046057701, 3.086827501654625, 3.004757300019264, 2.950575590133667, 2.9662897884845734, 2.8950121104717255, 1.6731617897748947, 0.8340482003986835, 0.6865398064255714, 0.6638469658792019, 0.5242763720452785, 0.5217284467071295, 0.5515142697840929, 0.4953689891844988, 0.4876623284071684, 0.4837468434125185, 0.4837724808603525, 0.4811186380684376, 0.4766754675656557, 0.4760030396282673, 0.4777332879602909, 0.4716674368828535, 0.4721231162548065, 0.472088485956192, 0.46965014562010765, 0.4670420940965414, 0.46612832695245743, 0.4660561289638281, 0.4633378330618143, 0.4598362687975168, 0.46294761449098587, 0.4623939096927643, 0.4611716065555811, 0.459350879304111, 0.4565950855612755, 0.45529736392199993, 0.4554514605551958, 0.45678873360157013, 0.4564306940883398, 0.4557976331561804, 0.4546752292662859, 0.4534771554172039, 0.45316144451498985, 0.45305261202156544, 0.4530079532414675, 0.45247172750532627, 0.45197475887835026, 0.45175592228770256, 0.45230100117623806, 0.4529536571353674, 0.45244174636900425, 0.45242172479629517, 0.45175342820584774, 0.45082317665219307, 0.4509485084563494, 0.4515317715704441, 0.4519385192543268, 0.451321667060256, 0.4511787351220846, 0.45095973648130894, 0.45027363672852516, 0.4501626566052437, 0.45075827464461327, 0.45082891173660755, 0.4503782596439123, 0.45080811716616154, 0.45002843253314495, 0.4501119665801525, 0.4498475845903158, 0.44948579277843237, 0.4497100953012705, 0.44870905578136444, 0.44929079804569483, 0.4492724062874913, 0.44987028557807207, 0.4507576022297144, 0.44964842963963747, 0.44941964093595743, 0.44935088511556387, 0.4485246343538165, 0.4476317996159196, 0.44791885279119015, 0.4486330356448889, 0.4486279347911477, 0.44829766545444727, 0.4486653646454215, 0.4485988887026906, 0.4487272324040532, 0.44765768852084875, 0.4483517426997423, 0.44848115649074316, 0.4474315829575062]

#
'''QAT'''
Train_Acc_list =  [6.8359375, 33.49609375, 35.3515625, 40.234375, 45.5078125, 41.11328125, 43.1640625, 42.578125, 46.875, 47.16796875, 45.703125, 44.62890625, 45.80078125, 44.140625, 48.4375, 46.77734375, 47.4609375, 49.12109375, 46.484375, 50.0, 47.75390625, 45.41015625, 56.34765625, 56.25, 55.859375, 56.73828125, 58.30078125, 57.421875, 55.46875, 58.984375, 56.0546875, 55.95703125, 58.10546875, 56.15234375, 66.015625, 68.84765625, 68.75, 75.9765625, 75.9765625, 73.14453125, 77.34375, 76.7578125, 76.3671875, 74.609375, 78.3203125, 76.26953125, 76.953125, 77.05078125, 77.1484375, 80.17578125, 77.24609375, 77.9296875, 76.7578125, 77.9296875, 80.2734375, 85.7421875, 88.18359375, 88.18359375, 87.40234375, 87.40234375, 86.62109375, 88.28125, 88.28125, 88.28125, 86.42578125, 86.62109375, 87.79296875, 89.6484375, 88.37890625, 86.42578125, 85.7421875, 86.1328125, 87.59765625, 89.55078125, 89.16015625, 87.890625, 87.40234375, 88.57421875, 87.59765625, 90.4296875, 88.8671875, 89.2578125, 88.4765625, 85.83984375, 87.01171875, 88.8671875, 86.71875, 86.328125, 87.890625, 88.18359375, 89.16015625, 88.18359375, 87.20703125, 88.0859375, 86.81640625, 89.35546875, 89.94140625, 87.59765625, 87.79296875, 88.76953125]
Train_Loss_list = [2.3248836994171143, 2.2631733417510986, 2.147960662841797, 1.868567705154419, 1.5075124502182007, 1.5556343793869019, 1.4455947875976562, 1.4888478517532349, 1.366988182067871, 1.341044545173645, 1.3793236017227173, 1.3799786567687988, 1.3679131269454956, 1.393150806427002, 1.278224229812622, 1.3228784799575806, 1.318408489227295, 1.2630987167358398, 1.3097968101501465, 1.2463620901107788, 1.2894902229309082, 1.347223162651062, 1.1693862676620483, 1.1195799112319946, 1.1166129112243652, 1.0889601707458496, 1.0351791381835938, 1.0679864883422852, 1.105141520500183, 1.0337791442871094, 1.0863174200057983, 1.0736793279647827, 1.0417566299438477, 1.071932077407837, 0.9541199803352356, 0.7957327365875244, 0.8362136483192444, 0.630565881729126, 0.6258371472358704, 0.6829977631568909, 0.5663200616836548, 0.5853409767150879, 0.5809115767478943, 0.6296742558479309, 0.5424752235412598, 0.6124027371406555, 0.5684308409690857, 0.5687008500099182, 0.573004424571991, 0.4996323585510254, 0.570414125919342, 0.5430938005447388, 0.5635592937469482, 0.5319926142692566, 0.5130099654197693, 0.3734867572784424, 0.2928764820098877, 0.3147912621498108, 0.32597067952156067, 0.3199101686477661, 0.33946213126182556, 0.30108752846717834, 0.29738321900367737, 0.28625866770744324, 0.3326302468776703, 0.33751222491264343, 0.3083243668079376, 0.25691699981689453, 0.2844073176383972, 0.3260265588760376, 0.3495051860809326, 0.3354056477546692, 0.2990136444568634, 0.2574882507324219, 0.26330456137657166, 0.3022724390029907, 0.3088274598121643, 0.28786128759384155, 0.2987668216228485, 0.23528333008289337, 0.27602654695510864, 0.27404308319091797, 0.2777131199836731, 0.34319382905960083, 0.3205484449863434, 0.28677719831466675, 0.31589430570602417, 0.3371981382369995, 0.3028481900691986, 0.2959989607334137, 0.2684873938560486, 0.28743886947631836, 0.31863152980804443, 0.29182514548301697, 0.3165145218372345, 0.2659955620765686, 0.24658384919166565, 0.3046662211418152, 0.3059040307998657, 0.2785661518573761]
Test_Acc_list = [14.92, 32.15, 33.37, 40.82, 43.9, 44.06, 44.89, 45.09, 45.67, 45.85, 45.43, 46.18, 46.3, 46.37, 46.55, 46.63, 46.6, 46.9, 46.92, 47.11, 47.06, 47.12, 56.14, 56.25, 55.89, 56.23, 56.78, 56.84, 57.0, 56.97, 57.13, 57.07, 57.19, 57.36, 66.44, 65.8, 75.12, 75.98, 76.39, 76.44, 76.48, 76.63, 77.09, 77.15, 77.19, 77.1, 77.34, 77.23, 77.25, 77.29, 77.57, 77.39, 77.48, 77.64, 85.06, 86.57, 86.72, 86.83, 86.84, 86.97, 87.0, 87.11, 86.92, 87.07, 87.22, 87.11, 87.19, 87.29, 87.19, 87.07, 87.16, 87.23, 87.26, 87.22, 87.24, 87.29, 87.3, 87.23, 87.27, 87.26, 87.25, 87.25, 87.26, 87.23, 87.22, 87.29, 87.28, 87.29, 87.31, 87.24, 87.24, 87.29, 87.28, 87.27, 87.27, 87.24, 87.32, 87.27, 87.28, 87.32]
Test_Loss_list = [23.004416942596436, 22.61537456512451, 21.42760682106018, 18.177395224571228, 15.14647912979126, 14.590125799179077, 14.147441387176514, 14.03854238986969, 13.82498836517334, 13.732856035232544, 13.780864238739014, 13.559933543205261, 13.46997058391571, 13.4036945104599, 13.321685791015625, 13.319101333618164, 13.221964716911316, 13.130152583122253, 13.066904425621033, 13.003782749176025, 13.048457622528076, 13.008087038993835, 11.565793871879578, 11.168013215065002, 11.084045648574829, 10.929198503494263, 10.787518739700317, 10.702410578727722, 10.620407819747925, 10.587213158607483, 10.545571088790894, 10.536885142326355, 10.479483544826508, 10.413989126682281, 8.829814612865448, 8.59644103050232, 7.745667099952698, 6.280221462249756, 6.044846773147583, 5.944713830947876, 5.971476435661316, 5.883290112018585, 5.734992146492004, 5.659598290920258, 5.647120535373688, 5.678666114807129, 5.574876308441162, 5.603989005088806, 5.582381963729858, 5.527096182107925, 5.481921315193176, 5.533539593219757, 5.510351479053497, 5.443101584911346, 5.011901319026947, 3.440565824508667, 3.3046089112758636, 3.312046140432358, 3.266344130039215, 3.2028592824935913, 3.222287207841873, 3.1845268607139587, 3.1839209496974945, 3.167006880044937, 3.1245696544647217, 3.1436923444271088, 3.1416924595832825, 3.10958993434906, 3.1321891248226166, 3.1181269586086273, 3.1195249557495117, 3.0885415077209473, 3.0960197746753693, 3.088674694299698, 3.080277740955353, 3.0904541313648224, 3.0858201384544373, 3.0846774876117706, 3.0799355506896973, 3.080420643091202, 3.0888573229312897, 3.0869343280792236, 3.0842500030994415, 3.084700286388397, 3.088733345270157, 3.094054937362671, 3.0887975990772247, 3.087354212999344, 3.087677389383316, 3.086930215358734, 3.090216726064682, 3.091078281402588, 3.0918487906455994, 3.0884012281894684, 3.083355575799942, 3.0907407104969025, 3.0873566269874573, 3.087390512228012, 3.0860905945301056, 3.086670607328415]

'''Draw-1 '''
list1 = Train_Acc_list
list2 = Test_Acc_list

print(len(Train_Acc_list), len(Train_Loss_list),
      len(Test_Acc_list), len(Test_Loss_list))

Net = '-mnistcnn'
label1 = 'Train_Acc'
label2 = 'Test_Acc'
plt.figure()
# plt.plot([x/12 for x in range(len(list1))], list1,
#          label=label1+Net)
# plt.plot([x/12 for x in range(len(list2))], list2,
#         label=label2+Net)

print([x1 for x1 in range(0, len(list1), 6)])
#
# plt.plot([x1 for x1 in range(0, 20)], [list1[x1] for x1 in range(0, len(list1), 6)],
#          label=label1+Net)
plt.plot([x1/5 for x1 in range(len(list1))], list1,
        label=label1+Net)
plt.plot([x1/5 for x1 in range(len(list2))], list2,
        label=label2+Net)

# plt.scatter(3,76,s=100,color='b')
# #画虚线
# plt.plot([3,3],[76,0],'g--',lw=2)
#r'$xxxx$'
#xy=蓝色点位置
#xytext：描述框相对xy位置
#textcoords='offset points'，以xy为原点偏移xytext
#arrowprops = 画弧线箭头，'---->', rad=.2-->0.2弧度

# plt.annotate(r'QAT-begin',xy=(3,0),xytext=(+30,-30),textcoords='offset points',fontsize=30,
#              arrowprops=dict(arrowstyle='->',connectionstyle='arc3,rad=.2'))
#放置纯文字描述
#位置:-2,2
#内容：r'$xxxx$'
# plt.text(3,60,r'$QAT-begin$',fontdict={'size':'24','color':'b'})

# plt.xticks(fontsize=30)
# plt.yticks(fontsize=30)

plt.ylim((0, 100))
plt.yticks(np.arange(0, 101, 5))

plt.legend(loc='center', fontsize=30) # 显示图例
plt.xlabel('epoch', fontsize=30)
plt.ylabel('Top-1 Accuracy(%)', fontsize=30)
# new_ticks = [i for i in range(1,11)]
# print(new_ticks)
# plt.xticks(new_ticks)
plt.show()